name: Deploy on Commit

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: 檢出代碼
        uses: actions/checkout@v4 # 更新到最新版本以獲得更好支持

      - name: 設置 Node.js
        uses: actions/setup-node@v4 # 更新到最新版本
        with:
          node-version: '18' # 升級到 Node.js 18 以解決兼容性問題

      - name: 安裝依賴
        run: npm install

      - name: 配置 Git
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"

      - name: 運行部署腳本
        run: npm run deploy
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # 確保 gh-pages 可進行身份驗證